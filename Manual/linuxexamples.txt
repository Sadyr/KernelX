 Разделы  linux
 Работа с сетью
        Назначение ip адреса и  маршрута  по пумолчанию с командой ip
            Сначала сбросить сетевой интерфейс
                ip addr flush dev eth0
            Назначаем интерфейсу ip
                ip addr add dev eth0
            Проверить конфиг файл
                vim /etc/sysconfig/network-scripts/ifcfg-eth0
            Включить интерфейс
                 ip link set dev eth0 up
            Отключить интерфейс
                 ip link set dev eth0 down
            При настройки сети проверять промежуточно командами
                ip route, ping 8.8.8.8, tracecoute
            Чтобы узнать через какой шлюз мы попадем к определенном4у адресу, нужна команда
                ip route get 192.168.2.45
            Чтобы добавить статический маршрут для нашей подсети, нужна команда
                 ip route add default via 192.168.1.1
            Перезагрузить сетевые интерфейсы
                 service network restart
            Для проверки узла использовать утилиту traceroyte
                traceroute ps.kz
            Конфиг файл резолвера находится по адресу
                 /etc/resolve.conf
            1. Как сделать пинг и трассировку в OC Windows?
            https://discourse.corp.ps.kz/t/kak-sdelat-ping-i-trassirovku-v-oc-windows/199
            2.
Работа с SSH
        Установка клиента и сервера
            yum –y install openssh-server openssh-clients
        проверить статус sshd
            systemctl status sshd
        Остановить sshd
            systemctl stop sshd
        Перезагрузить
             Service sshd restart
        Запустить sshd
             systemctl sshd start
        Подключиться удаленно к серверу
             ssh root@78.40.109.99 -p 22
        включение по умолчанию вместе с системой
              systemctl enable ssh
        генерация ssh ключей
             ssh-keygen
        где они нахиодятся
            cd ~/.ssh/
        скопировать на сервер публичные ключи
        1-способ
             ssh-copy-id root@78.40.109.99
        2-способ
             cat ~/.ssh/id_rsa.pub | ssh root@78.40.109.99 'cat >> ~/.ssh/authorized_keys'
КОМАНДА TOP
    значение верхних обозначений в таблице
         PID - номер процесса
         USER - пользователь запустивний процесс
         PR - приоритет запущенной программа
         NI - Приоритет присвоенной ему командой NICE
         VIRT - виртаульная память которую использует процесс
         RES - Физическая память занятым данным процессом
         SHR - Общий обьем памяти который данный процесс делит с остаальными
         S - текущий статус процесса ,sleping, running, zimbie
         %CPU — процент используемого времени центрального процессора
        **%MEM — процент ОЗУ, используемой процессом
        **TIME+ — продолжительность работы процесса с момента запуска
        **COMMAND — название команды (программы), которая инициировала процесс.
    Расшифровка данных перед таблицей
        ** текущее время
        ** up — продолжительность работы системы с момента запуска
        ** user — текущее количество пользователей системы
        ** load average — средняя загруженность системы одну минуту назад, пять и 15 соответственно.
        Считается, что в норме данный показатель не должен превышать 1 для одноядерных процессоров.
        Соответственно, значение load average, равное количеству ядер, является предельным.
    Сортировка даннных
        Сортировка по памяти (MEMory)
            shift+M
        Сортировка по времени (TIME)
            shift+T
        Сортировка по номеру процесс (PID)
            shift+N

        Чтобы вернуться к режиму сортировки по уровню потребления ресурсов процессора, воспользуйтесь комбинацией Shift+P.
 Анализ сетевой активностит с командой ss
        ss - Команда ss без каких-либо параметров отобразит все открытые сокеты (например, TCP/UNIX/UDP), которые установили соединение.
         Обозначение
         Netid - отображает типы сокетов.
         State: отображает состояние сокета, если он установлен (ESTAB), Не подключен (UNCONN) или прослушивается (LISTEN).
         Recv-Q: этот столбец отображает количество принятых пакетов в очереди.
         Send-Q: данная колонка отображает количество отправленных пакетов в очереди.
         Local address:port: показывает адрес локальной машины и порт.
         Peer address:port: отображает адрес удаленной машины и порт.
        ss - l   -  Для отображения списка прослушиваемых сокетов используйте опцию -l или --listen.
        ss -a    - Вы можете отобразить все прослушивающие и не прослушивающие сетевые подключения, используя опцию -a или-all.
        ss -tt    - Чтобы отобразить соединение TCP-сокета, используйте опцию -tили--tcp.
        ss -at     - Чтобы отобразить список всех TCP-соединений, вы можете использовать параметры -a и -t одновременно. Это включает в себя состояние всех сокетов.
        ss -alt - Чтобы отобразить TCP — соединение для всех состояний, объедините параметры -l и -t.
        ss -u -p   -Чтобы показать подключение к сокету UDP, используйте опцию -u  или--udp.
        ss -au  -p -  Чтобы отобразить список всех UDP подключений, используйте параметры-a и -u. Это включит в себя состояния сокета.
        ss -f unix   - Чтобы отобразить все сокеты Unix, вы можете использовать команду ss вместе с -f unix или -x.
        ss -w    - Чтобы отобразить все необработанные сокеты, вы можете использовать опцию -w или --raw.
        ss dst 192.168.1.12 - Мы можем использовать команду ss для отображения списка соединений определенного IP-адреса назначения или источника.
        ss src 192.168.1.12 - Например, чтобы указать подключение исходного IP-адреса:
        ss -4  or ss -6   - Если вы хотите отобразить список подключений сокетов IPv4, используйте опции -4 и -6 для отображения списка подключений сокетов.
        ss -at4   - Чтобы посмотреть все TCP-соединения IPv4, вы можете использовать следующий пример.
        ss -t -p   - Вы можете найти процессы сокетов, используя опцию -p вместе с командой ss. Чтобы идентифицировать процесс, вам потребуется пользователь с sudo.
        ss -tr
        ss -tn - Для разрешения числового адреса/портов используйте параметр -r (resolve). В то время как параметр -n — не разрешает имена служб.
        ss -t state lostening -Чтобы отфильтровать TCP-соединение с прослушиванием состояния, введите:
        ss -tr state established '( dport = :22 or sport = :22 )' - Для отображения установленных подключений к ssh— портам используйте эут команду:
        $ ss -at | grep LISTEN  - Вы также можете использовать традиционный способ команды grep для фильтрации. Здесь я показываю все TCP-соединения, которые прослушиваются
        ss -tn src :22 | grep -i "estab" | wc -l -   Количество подключений на определенный порт

 Команда ps
        ps -A   - Все процессы, кроме лидеров групп, в том же режиме отображения:
        ps -d   - Все процессы, включая фоновые и лидеры групп:
        ps -f   - Чтобы вывести больше информации о процессах используйте опцию -f:
        При использовании опции -f команда выдает такие колонки:

            UID - пользователь, от имени которого запущен процесс;
            PID - идентификатор процесса;
            PPID - идентификатор родительского процесса;
            C - процент времени CPU, используемого процессом;
            STIME - время запуска процесса;
            TTY - терминал, из которого запущен процесс;
            TIME - общее время процессора, затраченное на выполнение процессора;
            CMD - команда запуска процессора;
            LWP - показывает потоки процессора;
            PRI - приоритет процесса.
            ps -fA   * Например, также можно вывести подробную информацию обо всех процессах:
             ps -Fe   - Больше информации можно получить, использовав опцию -F:
                та опция добавляет такие колонки:

                SZ - это размер процесса в памяти;
                RSS - реальный размер процесса в памяти;
                PSR - ядро процессора, на котором выполняется процесс.
          ps -l   - Если вы хотите получить еще больше информации, используйте вместо -f опцию -l:

                    Эта опция добавляет отображение таких колонок:

                    F - флаги, ассоциированные с этим процессом;
                    S - состояние процесса;
                    PRI - приоритет процесса в планировщике ядра Linux;
                    NI - рекомендованный приоритет процесса, можно менять;
                    ADDR - адрес процесса в памяти;
                    WCHAN - название функции ядра, из-за которой процесс находится в режиме ожидания.

           ps -fu root  - Дальше мы можем отобрать все процессы, запущенные от имени определенного пользователя:
           ps -fHu balerion      - С помощью опции -H можно отобразить дерево процессов:
           ps -fp 1 - Если вас интересует информация только об определенном процессе, то вы можете использовать опцию -p и указать PID процесса:
            ps -fC chrome -  Опция -С позволяет фильтровать процессы по имени, например, выберем только процессы chrome:





2. mv/rm/cp
 Создать новый каталог 'testdir1' и несколько файлов в нем (testfile1, testfile2, testfile3)
mkdir testdir1
touch testdir1/testfile1 testdir1/testdile2 testdir1/testfile3
 Сделать копию каталога 'testdir1' с именем 'testdir2'
cp -R testdir1 testdir2
 Переименовать каталог 'testdir1' в 'testdir3'
mv testdir1 testdir3
 Переместить каталог 'testdir3' в каталог 'testdir2'
mv testdir2 ./testdir3
 Удалить все файлы в каталоге 'testdir2'
rm -f testdir3/*
 Удалить каталог 'testdir2'
rm -R -f testdir3
3. ln
Создать жесткую ссылку и символьную ссылку.
ln file hardfile
ln -s file softfile
Понять в чем разница между ними.
4. find
◦ В домашнем каталоге пользователя найти все файлы, измененные больше месяца назад.
find / mtime 30
 find / -mtime +50 -mtime -100
 10. ПОИСК ПО ДАТЕ МОДИФИКАЦИИ
Поиск файлов по дате в Linux осуществляется с помощью параметра mtime. Найти все файлы модифицированные 50 дней назад:

find / -mtime 50

Поиск файлов в Linux открытых N дней назад:

 find / -atime 50

Найти все файлы, модифицированные между 50 и 100 дней назад:

 find / -mtime +50 -mtime -100

Найти файлы измененные в течении часа:

 find . -cmin 60
◦ В каталоге /etc найти все файлы, измененные в течении последних трех дней.
find /etc -mtime 0 -mtime -3
◦ В каталоге /usr найти с размером более 5 MB.
find /usr -size 0M -size -3M

 find / -size 50M

От пятидесяти до ста мегабайт:

 find / -size +50m -size -100M

Найти самые маленькие файлы:

 find . -type f -exec ls -s {} \; | sort -n -r | head -5

Самые большие:

 find . -type f -exec ls -s {} \; | sort -n | head -5
 
 5. grep
◦ В каталоге /etc найти все файлы, которые содержат имя вашего пользователя (только имена файлов, без текста)
grep root ./*

◦ В файле /etc/passwd подсчитать количество строк, содержащих слово 'system'.
grep -ic System /etc/passwd

6.head/tail
◦ Вывести первую строку файла /etc/passwd
head -n2 /etc/passwd
◦ Вывести последнюю строку файла /etc/passwd
tail -n3 /etc/passwd
2. Текстовые файлы
 Записать вывод команды «man less» в файл с названием vim_testfile.
man less > vim_testfile.txt
 Познакомиться с утилитой less, научиться пользоваться встроенной помощью, поиском по файлу и переходами к
первой и последней строке.
less vim_testfile.txt 
вверх 'y'
 вниз 'enter'
 выход q, Q, :q, :Q, ZZ — выход.
 Стрелка вверх – перемещение на одну строку вверх
Стрелка вниз – перемещение на одну строку вниз
Пробел или PgDn – перемещение на одну страницу вниз
b или PgUp – переместить на одну страницу вверх
g – переместить в начало файла
G – переместить в конец файла
ng – перейти на n-ю строку
 Научиться уверенно редактировать файлы при помощи vim: переход к определенной строке, удаление строки,
копирование и вставка строки и нескольких строк, замена одного слова на другое во всем файле.
открыть vim 
vim
режим ввода текста 
shift + i (Insert)
чтобы выйти из неизмененного файла 
:q
чтобы выйти из измененного файла не сохраняяя ее
:q!
чтобы выйти сохранив файл
:wq
Работа с курсором
H - left
L - right
K - up
J - down
Если в командном режиме нажать  букву 'a', курсор двинется в права и откроется режим редактирование текста
Если в командном режиме нажать  букву 'A', курсор двинется в конец строки и откроется режим редактирование текста
Если в командном режиме нажать  букву 'o', создает строку ниже текщий строки и откроется режим редактирование текста
Если в командном режиме нажать  букву 'O', создает строку выше текщий строки и откроется режим редактирование текста
Чтобы перейти в первую строку файла в командном режиме  нажать 'gg'
Чтобы перейти в последнию строку файла в командном режиме  нажать 'G'
ЧТобы переместиться в начало следующего слова нажать  'w'
ЧТобы переместиться в начало предыдущего слова нажать  'b'
ЧТобы переместиться в конец следующего слова нажать  'e'
Для выполнение команды несколько раз , нужно прописать в начало команды цифру : 2w, 10w, 5b
Чтобы оставить закладку в определенной строке  нажимаем 'm'(mark)  x(example), чтобы потом вернуться к этой строке нажмаем ' и  x
Перейти в режим выделение shift + v
Чтобы удалить выделенный текст нажать нужно 'x'


















3. Архивы и компрессоры.
 tar
◦ Создать новый каталог 'testdir1' и несколько файлов в нем (testfile1, testfile2, testfile3)
mkdir testdir1
touch ./testfile ./testfile2 ./testgfile3
◦ Создать tar архив каталога testdir1 без сжатия и со сжатием gzip/bzip2
создать архив из директории
tar cf mytar.tar testdir1
посмотреть что внутри архива 
tar tf mytar.tar
tar cvzf myGZIP.gz testdir1 (для bzip2 - tar cvjf myGZIP.bz2 testdir1)
распокавать архив обратно
tar xvf mytar2.tar
компрессия архивированного файла тар
gzip mytar2.tar
раскомпроссировать
gunzip mytar2.tar.gz   (bzip2 -  тоже самое , но компрессия лучше, раскомпрессировать bunzip2)
одновременно распаковать и компрессировать
tar cvzf myGZIP.gz testdir1
Распаковать в определенную папку

tar -C /home/user -xvf archive.tar.gz

* ключ -C используется для указания папки, куда необходимо распаковать файлы из архива.
tar -xvf mytar2.tar -C ./testdir2
tar -xf mytar.tar.gz -C ./testdir3

tar (child) :bman bzip2
◦ Просмотреть содержимое любого tar-архива
◦ Распаковать любой из созданный архивов в новый каталог 'testdir2'
◦ Распаковать из tar-архива только один файл testfile3. При выполнении, использовать полные названия ключей.
tar xvf mytar.tar.gz testdir1 -C ./sa

◦ Важно ли записывать ключи в определенной последовательности и если да, то почему?
 gzip, bzip2
◦ Сжать/разжать распакованный в предыдущем задании файл с помощью gzip/gunzip
◦ Сжать/разжать распакованный в предыдущем задании файл с помощью bzip2/bunzip2
 unzip
◦ Скачать при помощи консольной программы wget zip-архив с последней Joomla и распаковать ее в новый
каталог «testjoomla»
wget https://ru.wordpress.org/latest-ru_RU.zip

unzip latest.zip -d ./sadir

4. Права доступа
 Создать новый каталог 'testdir1' и несколько файлов в нем (testfile1, testfile2, testfile3).
 Для каталога testdir1 установить такие права, чтобы владелец мог писать, читать и исполнять, а остальные только читать и исполнять.
установить для папки testdir1 все права пользователя
chmod u+rwx ./right
забрать у группы и у других все права
chmod go-rwx ./right
предосатавить группам и другим польз права на чтение и выполнение
chmod go+rx ./right


 Для файла testfile1 - владелец может писать и читать, а остальные только читать.  
chmod u+rw testfile1
забрать у всех пользователей все права
chmod ugo-rwx testfile1
chmod go+r testfile1


 testfile2 - владелец может читать, писать и исполнять, остальные не могут ничего.
chmod go-rwx testfile2
chmod u+x testfile2
 testfile3 - владелец может только читать, группа исполнять, остальные только писать.
chmod ugo-rwx testfile3
chmod u+r testfile3
chmod g+x testfile3
chmod o+w testfile3
 Сменить владельца на каталоге testdir1 и на всех вложенных файлах на root, а группу - на users.
chgrp users ./right
chown root ./right


 Понять какое значение несет право на выполнение для каталогов и файлов и что будет, если с каталога или файла
забрать право на выполнение.

5. Сетевые утилиты
 ping: Отправить 5 пингов на хост ps.kz. Понимать значение всех полей в выводе команды.
ping -c3 ps.kz

 traceroute/tracepath: Выполнить трассировку ps.kz и ya.ru. Понять механизм работы.
traceroute ps.kz

 dig/nslookup: Определить A, MX, NS, TXT и SOA записи домена ps.kz используя разные резолверы.
dig @8.8.8.8 ps.kz A +noall +answer
dig @8.8.8.8 ps.kz MX +noall +answer
dig @8.8.8.8 ps.kz NS +noall +answer
nslookup -type=NS ps.kz



 whois : Вывести WHOIS-информацию для домена ps.kz. Понять вывод.
whois ps.kz
 telnet: выполнить GET-запрос на любой сайт
telnet ps.kz 80

GET /


8. Анализ нагрузки на сервер
 Познакомиться с утилитой ps.
 Познакомиться с утилитой top, знать все параметры вывода по умолчанию.
top 
Если вы хотите отображать только те процессы, которые используют ресурсы процессора используйте команду i:


 При помощи top, показать все процессы запущенные в пространстве ядра.



6. Файловая система
 Узнать назначение основных каталогов в Linux
 df: получить список доступных ФС в системе, понять значение всех полей
df -h
df df -t ext4
Если задать опцию -a, вы можете получить информацию обо всех файловых системах известных ядру, которые были смонтированы:
df -a
сли вы хотите вывести только информацию про реальные файловые системы на жестком диске можно использовать опцию -x чтобы отфильтровать все tmpfs:
 df -x tmpfs
Или же указать файловую систему, которую нужно отображать:

 df -t ext4
Также можно указать интересующий вас раздел, как вы видели в синтаксисе команды:
 df -h /dev/sdb6
 du: получить информацию о занимаемом дисковом пространстве дочерними элементами каталога /usr/ (не глубже
первого уровня). Отсортировать вывод от меньшего к большему.
По умолчанию размер выводится в байтах. Для того чтобы размер выводился в более читабельном виде используйте опцию -h:
du -h /var
Если надо выводить размер не только папок, но и файлов, которые там находятся используйте опцию -a:

du -ha /var
Для того чтобы вывести только общий размер всех файлов и папок нужно применить опцию -s:

du -hs /var
Если вам надо исключить какие-либо файлы из подсчёта, следует использовать опцию -exclude. Например, давайте исключим все лог файлы:

du -hac --exclude="*.log"
Чтобы данные были более наглядными их желательно отсортировать. Встроенной поддержки сортировки в du linux нет, зато можно воспользоваться утилитой sort с опцией -h. Эта опция нужна чтобы сортировались единицы измерения в понятном для чтения формате:

du -h /var | sort -h
du -h /usr/ |  sort -h
-d, --max-depth - максимальная глубина вложенности директорий;
du -d1 /usr/
f
 mount: получить информацию о смонтированных ФС и научиться монтировать/отмонтировать файловые системы
 Найти в системе диск размером в 100 Mb и смонтировать его в папку mnt с правами только на чтение. После
перезагрузки, он должен остаться примонтированным .
поиск разделов и дисков в системе 
fdisk -l
выбираем диск который нам интересен для ознакомление
fdisk /dev/vdb
Создание раздела нажать n
далее по умоляанию
выбирать размер 
в конце нажать w для сохранение
 После того как создали разделы, нужно их отформотировать под определенные форматы
 форматнем первый раздел
 mkfs -t ext4 /dev/vdb1
 Теперь создадим разделы тома
 mount -t ext4 /dev/vdb1 ./1ext
mount -t ext4 /dev/vdb2 ./2ext
mount -t ext4 /dev/vdb3 ./3ext
чтобы посимотреть какие у нас есть разделы
 lsblk

 telnet: выполнить отправку почты через любой ваш почтовый аккаунт

Посмотреть структуру файловой системы можно используя команду ls -la. Ниже приведен пример вывода команды для дистрибутива OpenSUSE.
9. Планировщик задач
посмотреть все задания в крон текущего пользователя 
crontab -l
Все задачи cron разделены по пользователям, и команды из этих задач будут выполнятся от имени того пользователя, для которого они были добавлены. Чтобы посмотреть задачи другого пользователя используйте опцию -u:
sudo crontab -u root -l
ГлавнаяИнструкцииКак добавить команду в Cron
КАК ДОБАВИТЬ КОМАНДУ В CRONИнструкции Обновлено:  14 мая, 2020  9  admin 
 ubuntu
При администрировании и настройке серверов очень часто надо настраивать автоматическое выполнение определенных скриптов или программ через равные промежутки времени. Это может быть резервное копирование, отправка отчётов о состоянии сервера или другие тому подобные вещи.
Служба cron - это стандартный планировщик задач в Linux. С помощью него вы можете запланировать выполнение команды или скрипта один или несколько раз, в определенную минуту, час, день, неделю и месяц. В этой статье мы подробно рассмотрим как выполняется настройка Cron в Linux на примере дистрибутива Ubuntu.
Как посмотреть задания cron
Добавление команды в cron
Выводы
КАК ПОСМОТРЕТЬ ЗАДАНИЯ CRON
Думаю, что начать следует не с настройки, а именно как посмотреть уже настроенные задачи cron. На самом деле задачи хранятся в трёх местах:
База данных crontab - здесь хранятся все записи cron пользователя, которые вы настраиваете вручную;
/etc/crontab и /etc/cron.d/ - системные записи cron и записи cron различных пакетов;
/etc/cron.hourly, /etc/cron.daily, /etc/cron.weekly, /etc/cron.monthly - здесь лежат скрипты, которые надо выполнять раз в час, день, неделю и месяц соответственно, обычно эти папки используются различными пакетами, но вы тоже можете их использовать для своих скриптов.
Чтобы посмотреть задания cron добавленные текущим пользователем используйте команду crontab и опцию -l:

crontab -l

Все задачи cron разделены по пользователям, и команды из этих задач будут выполнятся от имени того пользователя, для которого они были добавлены. Чтобы посмотреть задачи другого пользователя используйте опцию -u:

sudo crontab -u root -l

А теперь давайте поговорим о том, как добавить команду cron для нужного вам пользователя.

ДОБАВЛЕНИЕ КОМАНДЫ В CRON
Чтобы добавить задание cron из терминала можно использовать утилиту crontab. Для открытия временного файла с текущими заданиями этого пользователя выполните:

 crontab -e
 добавляем задание в крон
 * 23 * * * /usr/local/bin/script2.sh
 создаем баш скрипт 
 vim /usr/local/bin/script2.sh
указываем в первой строке 
#!/bin/bash


 Запланировать ежедневную архивацию каталога /home с сохранением в каталог /mnt
#!/bin/bash
string1="hello "
string2=world
string=$string1$string2\ and\ me
string3=$string1$string2" and me"
echo $string3

#!/bin/bash
tar cvf /root/test2.tar /root/testdir2
mv /root/test2.tar /root/sadir
~                               
 Запланировать перезагрузку каждый час каждую пятницу тринадцатого

Настройка сети в linux
Настройка линукс после переустановки ОС
Обновить пакетный менеджер юм
yum update
для установки сетевых утилит
yum install bind-utils
yum install net-tools
У
Установка ssh
Введите следующую команду, чтобы начать процесс установки:

sudo yum –y install openssh-server openssh-clients
service sshd restarts
$ sudo systemctl status sshd
$ service sshd status
1-шаг:
Узнать Ip адрес сервера
ip a
Узнать маску подсети
ip a
узнать ip адрес текущего шлюза (gateway)
ip route show match 0/0
сканировать локальную сеть, чтобы узнать какие еще ip адреса в этой сети испольхуются
nmap -sn 192.168.4.0/24
Открываем конфигурационный файл интерфейса езернет
vim /etc/sysconfig/network-scripts/ifcfg-eth0
меняем ip с 78,40.189.99/24 на 78,40.189.21/24
Теперь добавляем ip адрес к интерфейсу eth0 78,40.189.99/24
ip addr add 78,40.189.99/255.255.255.0 dev eth0
теперб удаляем ранее добавленный ip  78,40.189.21/24
ip addr add 78,40.189.21/255.255.255.0 dev eth0
 сбросить настройки интерфейса
 ip addr flush dev eth0
 vim /etc/sysconfig/network-scripts/ifcfg_eth0
Работа с базы данных
 Работа с почтовыми серверами
 Работа по передачи файлов
 Разм\вертывание приложения
 Работа с сайтом (как клиент)
